<div class="auth-container">
  <div class="auth-card">
    <div class="auth-header">
      <h2 class="auth-title">‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h2>
      <p class="auth-subtitle">‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</p>
    </div>
    <form id="forgotForm" class="auth-form">
      <div class="form-group">
        <label for="forgotEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
        <input type="email" id="forgotEmail" name="email" class="form-input" required>
      </div>
      <div class="form-group">
        <label for="newPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</label>
        <input type="password" id="newPassword" name="password" class="form-input" required minlength="6">
      </div>
      <div class="form-actions">
        <!-- ‡πÉ‡∏ä‡πâ onclick ‡∏ö‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ó‡∏ô -->
        <button type="button" class="btn btn-primary" onclick="handleResetClick()">üîê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
        <button type="button" class="btn btn-secondary" onclick="loadView('login')">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
      </div>
    </form>
  </div>
</div>

<style>
  :root {
    --bg-color: #ffffff;
    --bg-secondary: #f7f9fc;
    --text-color: #111111;
    --text-secondary: #666666;
    --border-color: #dddddd;
    --google-blue: #1a73e8;
    --google-blue-hover: #1765cc;
    --shadow-2: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  [data-theme="dark"] {
    --bg-color: #1e1e1e;
    --bg-secondary: #121212;
    --text-color: #f1f1f1;
    --text-secondary: #bbbbbb;
    --border-color: #333333;
    --google-blue: #8ab4f8;
    --google-blue-hover: #aecbfa;
    --shadow-2: 0 4px 12px rgba(0, 0, 0, 0.5);
  }
</style>

<!-- <script>
  // ‡πÉ‡∏ä‡πâ setTimeout ‡πÅ‡∏ó‡∏ô safeReady
  setTimeout(function() {
    const form = document.getElementById('forgotForm');
    if (!form) {
      console.error('‚ùå ForgotPassword form not found');
      return;
    }

    const btn = form.querySelector('button[type="submit"]');
    console.log('‚úÖ ForgotPassword form found, attaching event listener');

    form.addEventListener('submit', function (e) {
      e.preventDefault();
      console.log('üîê ForgotPassword form submitted');
      
      clearErrors();

      const email = document.getElementById('forgotEmail').value.trim();
      const password = document.getElementById('newPassword').value.trim();

      console.log('üìã Form data:', { email, passwordLength: password.length });

      if (!email || !isValidEmail(email)) {
        showError('forgotEmail', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
        return;
      }

      if (!password || password.length < 4) {
        showError('newPassword', '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 4 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
        return;
      }

      btn.disabled = true;
      const originalText = btn.innerHTML;
      btn.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô...';

      const userData = { email, password };
      console.log('üöÄ Sending reset password request');

      if (typeof google !== 'undefined' && google.script && google.script.run) {
        google.script.run
          .withSuccessHandler(function (result) {
            console.log('‚úÖ Password reset successful:', result);
            btn.disabled = false;
            btn.innerHTML = originalText;

            if (typeof Swal !== 'undefined') {
              Swal.fire({
                icon: 'success',
                title: '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                text: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...',
                timer: 2000,
                showConfirmButton: false
              });
            } else {
              alert('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
            }

            form.reset();
            setTimeout(() => {
              if (typeof loadView === 'function') {
                loadView('login');
              } else {
                location.reload();
              }
            }, 2000);
          })
          .withFailureHandler(function (error) {
            console.error('‚ùå Password reset failed:', error);
            btn.disabled = false;
            btn.innerHTML = originalText;

            if (typeof Swal !== 'undefined') {
              Swal.fire({
                icon: 'error',
                title: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ',
                text: error.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà'
              });
            } else {
              alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ: ' + (error.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î'));
            }
          })
          .resetPassword(userData);
      } else {
        console.warn('‚ö†Ô∏è Google Apps Script not available - testing mode');
        setTimeout(() => {
          btn.disabled = false;
          btn.innerHTML = originalText;
          alert('‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GAS');
        }, 1000);
      }
    });

    // Auto-focus first input
    const emailInput = document.getElementById('forgotEmail');
    if (emailInput) {
      emailInput.focus();
    }
  }, 200);

  // Helper functions (same as before)
  function showError(fieldId, message) {
    const field = document.getElementById(fieldId);
    if (field) {
      field.classList.add('error');
      const existingError = field.parentNode.querySelector('.error-message');
      if (existingError) existingError.remove();

      const errorDiv = document.createElement('div');
      errorDiv.className = 'error-message';
      errorDiv.innerHTML = `‚ö†Ô∏è ${message}`;
      field.parentNode.appendChild(errorDiv);
      field.focus();
    }
  }

  function clearErrors() {
    const errorFields = document.querySelectorAll('.form-input.error');
    errorFields.forEach(field => field.classList.remove('error'));

    const errorMessages = document.querySelectorAll('.error-message');
    errorMessages.forEach(msg => msg.remove());
  }

  function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
  }
</script> -->
